# 计算机网络-第七章


# 无线网络和移动网络
<!-- more --> 
## 基本概念
- 基站：负责协调与之关联的多个无线主机之间数据的传输。比如蜂窝塔，802.11无线LAN中的接入点。
- 基础设施模式：与基站关联的主机以此模式运行。
- 网络基础设施：无线主机希望与之进行通信的更大的网络。

- 单跳和多跳：
  - 单跳网络：在传统的无线局域网(WLAN)中，每个客户端均通过一条与AP相连的无线链路来访问网络，用户如果要进行相互通信的话，必须首先访问一个固定的接入点(AP)，这种网络结构被称为单跳网络。
  - 多跳网络：在无线多跳网络中，源结点到目的结点之间的典型路径是由多跳组成的，该路径上的中间结点充当转发结点。
  - ![单跳和多跳](/images/documents/计算机网络-第七章/单跳多跳网络.jpg)
- **信噪比(SNR)**：所收到的信号和噪声强度的相对测量，信噪比越高，接收方越容易从背景噪声中提取信号。
- **比特差错率(BER)**：接收方收到有错传输比特的概率。



## 无线网络和有线网络的区别
- 无线网络中信号强度逐渐递减。
- 无线网络中信号会受到其他源的影响。
- 无线网络中由于电磁波被反射等影响会出现多径传播。

## Ad-Hoc Network
- Ad-hoc网络是由相互直接通信的各个设备组成的网络,常常绕过集中的接入点。是点到点的网络，没有基站。

## IEEE 802.11 wireless LAN(WiFi)
- 工作的主要频段：2.4GHz 和 5GHz
- 体系结构(Architecture):
  - BSS(基本服务集)：包含一个或多个无线站点和一个接入点(AP)的中央基站，每一个站点和基站都有理论上唯一的6字节的MAC地址存储在该站的适配器(网卡)中。
  - ESS(拓展服务集)：由DS(分布式系统)连接多个BSS构成，这个DS可以是交换机，有线网络或无线网络，其作为一个逻辑局域网出现。

## IEEE 802.11 services
- Distribution service and Intergration service
  - Distribution service: 在ESS中如果一个帧要从一个站点到达另一个BSS中另一个站点，则需要使用该服务，如果两个站点在同一个BSS中，则该服务逻辑上使用单个AP.
  - Intergration service: 当一个站点要发送一个帧到达LAN中时，就使用Intergration service。
   ![DS and IS](/images/documents/计算机网络-第七章/DSandIS.jpg)
  - IEEE 802.1X是IEEE制定关于用户接入网络的认证标准,在用户接入网络（可以是以太网／802.3或者WLAN网）之前运行。
- Authentication/Deauthentication
  - 用于建立站点之间的联系，可在association之前使用。
  - 即wifi是否需要输入密码。
- Privacy
  - 每一个AP都会对传输的数据加密。
- Association/Reassociation/Disassociation
  - association服务目的是建立站点和AP之间的一条虚拟线路，同时使的在ESS中的AP之间可以互相通信。
  - reassociation服务使得站点可以从一个BSS移动到另一个BSS中，即切换associate的AP
  - disassociation服务终止关联。

## 主动扫描和被动扫描
- 被动扫描：
  - 每个AP每个一定时间在自身所在信道中发送一个**信标帧**(含AP的SSID(服务集标识)和MAC地址)。
  - 设备扫描所有信道获取信标帧，选择一个AP发送**关联请求帧**
  - AP向设备发送**关联响应帧**.
- 主动扫描：
  - 设备发送**广播探测帧**。
  - AP发送探测响应。
  - 设备选择AP发送**关联请求帧**。
  - AP向设备发送**关联响应帧**。
  
## 802.11 MAC协议
- 同一信道可能冲突所以需要一个**多路访问协议**来协调，选用**随机访问协议(CSMA/CA)**
  - CSMA/CA是尽可能避免冲突而CSMA/CD是冲突检测，这是因为：
    - 冲突检测能力要求站点具有同时传输和接收数据的能力，而在无线网络中，发送的信号强度远大于接收的信号强度，制造硬件成本过高
    - 即使拥有这样的硬件，但也会因为**隐藏终端**和**信号衰减**问题无法检测到所有的冲突。
  - 802.11 链路层确认方案，接收方接收完发送方发送的数据帧后，等待一个**SIFS(短帧间间隔)**发送一个**ACK帧**，如果发送方在规定时间内未收到则视为发送失败重发，重发超过一定次数则放弃。
  - CSMA/CA协议过程：
    - 某站点监听到信道空闲，等待一个**DIFS(分布式帧间间隔)**，发送帧。
    - 否则选取一个**随机回退值**，并在**侦听到信道空闲时递减该值**，信道忙时，保持该值不变。
    - 数值减为0时(此时一定信道空闲)，站点开始发送整个数据帧并等待确认。
    - 收到确认则知数据帧已经被成功接收，反之则回到步骤2并选取范围更大的回退值。
  - 如果向CSMA/CD协议中那样一旦检测到信道空闲就开始传输数据，那就很容易出现冲突。
  - 隐藏终端处理
    - 问题描述：A节点可以和B节点相互传输，B可以和C相互传输，但A不能直接和C相互传输，那么可能A,C之间互相听不到对方的传输而导致冲突。
    - 解决方法：使用**RTS**(请求发送控制帧)和**CTS**(允许发送控制帧)。发送方在发送数据帧之前要先发送一个RTS来抢占信道，AP收到RTS后会根据情况发送一个CTS，CTS同时通知发送方是否可以发送并且阻碍其他站点的发送。
  ![过程](/images/documents/计算机网络-第七章/CSMACA传输过程.png)
  - 除了SIFS和DIFS还有PIFS，其一般由AP使用，用于抢占信道，AP发送信息的优先级高于一般节点。
  - **PCF**(Point Coordination Function)
    - 在传输数据最初，AP会利用PIFS抢占信道，进入无竞争期间。
    - AP会轮询并使用**CF-Poll**帧来请求与其关联的站点发送数据，若没有数据则发送Null frame，并且如果AP采用的是**Data+CF-Poll**，站点还需在数据帧后加上**ACK帧**
    - AP接收到数据后会发送一个**CF-ACK**确认接收到数据，并用CF-Poll请求下一个站点。
    - 在轮询结束后AP会使用 **CF-end**帧来表示无竞争时期结束，各站点可以通过DIFS来抢占信道，发送信息。
    ![完整过程](/images/documents/计算机网络-第七章/PIFS.png)
  
## 802.11 MAC帧
- 管理帧：管理站点和AP是否关联，管理认证，同步等，比如**信标帧**
- 控制帧：CTS,RTS,ACK,CF-end,CF-ACK
- 数据帧：(Data) + CF-ACK/CF-Poll/CF-Poll+CF-ACK

## 网络性能
- 利用率: $U=\dfrac{Time~for~frame~transmission}{total~time~for~a~frame}$
- 相对传播时间：$a=\dfrac{propagation~time}{transimission~time}$
- 点对点的连接网络：
  - 设传输时间为1，则传播时间为a.
  - $U=\dfrac{1}{1+a}$
- 令牌环：
  - 设传输时间为1，则传播时间为a.同时设$T_1$为平均传输一个帧的时间，$T_2$为平均传输完成一个帧后将令牌传给下一个节点的时间，则$U=\dfrac{T_1}{T_1+T_2}$
  - 如果$a<1$即传播时间小于传输时间，则当第一个bit传播完成后，还未传输完成，所以$T_2=a/N(N为节点个数)$,所以$U=\dfrac{1}{1+a/N}$
  - 如果$a>1$即传播时间大于传输时间，则传输完成后还需要$a-1$的时间才能完成传播，所以$T_2 = a-1+a/N$，所以$U=\dfrac{1}{a+a/N}$
- 时隙ALOHA:
  - 设一个节点成功的概率为p,则在一个时隙中有一个节点成功传输的概率$Pr = Np(1-p)^{N-1}$,求得$p = 1/N$的时候取得最大值为$Pr_{max} = (1-1/N)^{N-1}$,当$N\rightarrow \infty,Pr = 1/e$
- ALOHA:
  - 设每个节点在每时隙传输的概率为p，一个时隙正好是一个帧传输的时间。
  - 设有一节点在$t_0$时开始传输，则其传输成功的条件是其他节点既不在$[t_0-1,t_0]$时隙中传输也不在$[t_0,t_0+1]$时隙中传输，所以任意一个时刻有一个节点成功传输的概率$Pr = Np(1-p)^{N}(1-p)^{N-1} = Np(1-p)^{2N-1}$，求得$p = 1/2N$时最大值为$Pr_{max} = 1/2(1-1/2N)^{2N-1}$，当$N\rightarrow \infty,Pr = 1/2e$
- CSMA/CD:
  ![CSMA/CD](/images/documents/计算机网络-第七章/CSMACDperformance.png)
  - 每一个冲突时隙的长度为2a(最坏情况)
  - 设在一个时隙传输的概率为p
  - 则一个节点成功传输的概率$Pr =Np(1-p)^{N-1}$，最大值为$(1-1/N)^{N-1}$ 
  - 因为有冲突我们考虑冲突次数的期望，考虑在一个冲突间隔中冲突时隙的个数恰为k个的概率$Pr_k=(1-A)^kA$(k个冲突后一个成功)，则期望为$\sum_{k=0}^{\infty}Pr_k = \dfrac{1-A}{A}$
  - 所以$U=\dfrac{1}{1+a+2a\times\dfrac{1-A}{A}}$，当$N\rightarrow\infty,Pr\rightarrow1/e,U =\dfrac{1}{1+(2e-1)a}$

## 802.11 帧
TBD

